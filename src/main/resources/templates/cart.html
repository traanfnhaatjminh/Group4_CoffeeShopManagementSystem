<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Cafe House Template</title>

    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,400italic,600,700' rel='stylesheet'
          type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Damion' rel='stylesheet' type='text/css'>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/font-awesome.min.css" rel="stylesheet">
    <link href="css/templatemo-style.css" rel="stylesheet">
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon"/>
    <link rel="stylesheet" type="text/css" href="/css/home.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

    <style>
        .h-custom {
            min-height: 100vh;
        }

        .shopping-cart {
            overflow: auto;
            max-height: calc(100vh - 100px);
            /* Adjust based on your header and footer height */
        }

        .tm-top-header,
        footer {
            position: relative;
            z-index: 1;
        }

        .tm-black-bg {
            position: relative;
            z-index: 1;
        }

        @media (min-width: 1025px) {
            .h-custom {
                height: 100vh !important;
            }
        }

        @media not all and (min-resolution: .001dpcm) {
            @supports (-webkit-appearance: none) and (stroke-color:transparent) {

                .number-input.def-number-input.safari_only button:before,
                .number-input.def-number-input.safari_only button:after {
                    margin-top: -.3rem;
                }
            }
        }

        .shopping-cart .def-number-input.number-input {
            border: none;
        }

        .shopping-cart .def-number-input.number-input input[type=number] {
            max-width: 2rem;
            border: none;
        }

        .shopping-cart .def-number-input.number-input input[type=number].black-text,
        .shopping-cart .def-number-input.number-input input.btn.btn-link[type=number],
        .shopping-cart .def-number-input.number-input input.md-toast-close-button[type=number]:hover,
        .shopping-cart .def-number-input.number-input input.md-toast-close-button[type=number]:focus {
            color: #212529 !important;
        }

        .shopping-cart .def-number-input.number-input button {
            width: 1rem;
        }

        .shopping-cart .def-number-input.number-input button:before,
        .shopping-cart .def-number-input.number-input button:after {
            width: .5rem;
        }

        .shopping-cart .def-number-input.number-input button.minus:before,
        .shopping-cart .def-number-input.number-input button.minus:after {
            background-color: #9e9e9e;
        }

        .shopping-cart .def-number-input.number-input button.plus:before,
        .shopping-cart .def-number-input.number-input button.plus:after {
            background-color: #4285f4;
        }

        .quantity {
            width: 40%;
        }

        .d-flex {
            display: flex;
        }

        .number-input {
            width: 60%;
        }

    </style>
</head>


<body>

<div class="tm-top-header">
    <div class="container">
        <div class="row">
            <div class="tm-top-header-inner">
                <div class="tm-logo-container">
                    <img src="img/logo.png" alt="Logo" class="tm-site-logo">
                    <h1 class="tm-site-name tm-handwriting-font">Coffee Shop</h1>
                </div>
                <div class="mobile-menu-icon">
                    <i class="fa fa-bars"></i>
                </div>
                <nav class="tm-nav">
                    <ul>
                        <li><a th:classappend="${currentPage == 'home'} ? 'active'" href="/homepage">Home</a></li>
                        <li><a th:classappend="${currentPage == 'menu'} ? 'active'" href="/menu">Menu</a></li>
                        <li><a href="#">Contact</a></li>
                        <li th:if="${#authorization.expression('isAnonymous()')}"><a href="/register">Register</a>
                        </li>
                        <li th:if="${#authorization.expression('isAnonymous()')}"><a href="/login">Login</a></li>
                        <li th:if="${user != null}"><a style="color: yellow" href="#"><span
                                th:text="${user.getUsername()}"></span></a></li>
                        <li th:classappend="${currentPage == 'profile'} ? 'active'" th:if="${user != null}"><a
                                href="/profile">Profile</a></li>
                        <li th:if="${user != null}">
                            <a th:classappend="${currentPage == 'cart'} ? 'active'"
                               class="nav-icon position-relative text-decoration-none" href="/cart">
                                <i class="fa fa-fw fa-cart-arrow-down text-dark mr-1"></i>
                                <span
                                        class="position-absolute top-0 left-100 translate-middle badge rounded-pill bg-light text-dark"
                                        th:text="${cartItems.size()}"></span>
                            </a>
                        </li>
                        <li th:if="${user != null}"><a href="/logout">Logout</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
</div>

<section class="h-100 h-custom" style="background-color: #eee;">
    <div class="container h-100 py-5">
        <div class="row d-flex justify-content-center align-items-center h-100">
            <div class="col">
                <form th:action="@{/cart/checkout}" method="post">
                    <div class="card shopping-cart" style="border-radius: 15px; width: 900px">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-lg-6 px-5 py-4">
                                    <h3 class="mb-5 pt-2 text-center fw-bold text-uppercase">Your cart</h3>

                                    <div th:each="cartItemWithProduct : ${cartItems}">
                                        <div class="d-flex align-items-center mb-5">
                                            <div class="flex-shrink-0">
                                                <img th:src="@{${cartItemWithProduct.product.image}}" class="img-fluid"
                                                     style="width: 150px;" alt="Product image">
                                            </div>
                                            <div class="flex-grow-1 ms-3">
                                                <h4 class="text-primary" th:text="${cartItemWithProduct.product.pname}">
                                                </h4>
                                                <div class="d-flex align-items-center" style="display: flex">
                                                    <p class="fw-bold mb-0 me-5 pe-3"
                                                       th:text="${cartItemWithProduct.product.getPrice() * cartItemWithProduct.cartItem.quantity} + ' VND'">
                                                    </p>
                                                    <form th:action="@{/cart/updateQuantity}" method="post">
                                                        <input type="hidden" name="productId"
                                                               th:value="${cartItemWithProduct.product.pid}">
                                                        <input type="hidden" name="cartItemId"
                                                               th:value="${cartItemWithProduct.cartItem.itemId}">
                                                        <div class="d-flex align-items-center">
                                                            <div class="number-input">

                                                                <label>
                                                                    <input class="quantity" min="0" name="quantity"
                                                                           th:value="${cartItemWithProduct.cartItem.quantity}"
                                                                           type="number">
                                                                </label>

                                                            </div>
                                                            <div>
                                                                <button type="submit"
                                                                        class="btn btn-primary ms-3"><i
                                                                        class="bi bi-check-circle"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </form>
                                                    <form th:action="@{/cart/delete}" method="post">
                                                        <input type="hidden" name="cartItemId"
                                                               th:value="${cartItemWithProduct.cartItem.itemId}">
                                                        <button type="submit" class="btn btn-danger">
                                                            <i class="bi bi-trash"></i>
                                                        </button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                        <hr class="mb-4" style="height: 2px; background-color: #1266f1; opacity: 1;">
                                    </div>


                                    <div class="d-flex justify-content-between px-x" style="display: flex">
                                        <p class="fw-bold">Discount:</p>
                                        <p class="fw-bold" style="margin-left: 10%">0%</p>
                                    </div>
                                    <div class="d-flex justify-content-between p-2 mb-2 bg-primary"
                                         style="display: flex">
                                        <h5 class="fw-bold mb-0">Total:</h5>
                                        <h5 class="fw-bold mb-0" style="margin-left: 10%"
                                            th:text="${totalPrice}+' VND'"></h5>
                                    </div>
                                </div>
                                <div class="col-lg-6 px-5 py-4">
                                    <h3 class="mb-5 pt-2 text-center fw-bold text-uppercase">Payment</h3>

                                    <div data-mdb-input-init class="form-outline mb-5">
                                        <label>
                                            <input type="text" class="form-control form-control-lg" name="phone"
                                                   placeholder="Enter your phone"/>
                                        </label>
                                    </div>

                                    <div data-mdb-input-init class="form-outline mb-5">
                                        <label>
                                            <input type="text" class="form-control form-control-lg" name="address"
                                                   placeholder="Enter your address"/>
                                        </label>
                                    </div>

                                    <h5>Choose payment method:</h5>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="paymentMethod"
                                               id="cashOnDelivery" value="cash">
                                        <label class="form-check-label" for="cashOnDelivery">
                                            Thanh toán khi nhận hàng
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="paymentMethod"
                                               id="bankTransfer" value="bank">
                                        <label class="form-check-label" for="bankTransfer">
                                            Chuyển khoản qua tài khoản ngân hàng
                                        </label>
                                    </div>

                                    <div id="qrCode" style="display: none; margin-top: 20px;">
                                        <img style="width: 50%" src="/img/qrcode.jpg" alt="QR Code"
                                             class="img-fluid">
                                        <p style="color: red">Quý khách vui lòng thanh toán trước khi nhấn "Buy
                                            now".</p>
                                    </div>

                                    <button type="submit" data-mdb-button-init data-mdb-ripple-init
                                            class="btn btn-primary btn-block btn-lg" style="margin: 10% 0;">Buy now
                                    </button>

                                    <div class="row mt-3" th:if="${successMessage}">
                                        <div class="col-12">
                                            <div class="alert alert-success" role="alert">
                                                <p th:text="${successMessage}"></p>
                                            </div>
                                        </div>
                                    </div>

                                    <h5 class="fw-bold mb-5">
                                        <a href="/menu">Back to shopping</a>
                                    </h5>
                                </div>

                            </div>
                        </div>
                    </div>
                </form>

            </div>
        </div>
    </div>
</section>


<footer>
    <div class="tm-black-bg">
        <div class="container">
            <div class="row margin-bottom-60">
                <nav class="col-lg-3 col-md-3 tm-footer-nav tm-footer-div">
                    <h3 class="tm-footer-div-title">Main Menu</h3>
                    <ul>
                        <li><a href="/homepage">Home</a></li>
                        <li><a href="/menu">Menu</a></li>
                        <li><a href="#">Contact</a></li>
                    </ul>
                </nav>
                <div class="col-lg-5 col-md-5 tm-footer-div">
                    <h3 class="tm-footer-div-title">About Us</h3>
                    <p class="margin-top-15">The Coffee Shop sẽ là nơi mọi người xích lại gần nhau, đề cao giá trị
                        kết
                        nối con người và sẻ chia thân tình bên những tách cà phê, ly trà đượm hương, truyền cảm hứng
                        về
                        lối sống hiện đại.</p>
                </div>
                <div class="col-lg-4 col-md-4 tm-footer-div">
                    <p><i class="bi bi-telephone"></i> Đặt hàng: 1800 6936</p>
                    <p><i class="bi bi-envelope"></i> Liên hệ</p>
                </div>
            </div>
        </div>
    </div>
    <div>
        <div class="container">
            <div class="row tm-copyright">
                <p class="col-lg-12 small copyright-text text-center">Copyright &copy; 2024 Coffee Shop</p>
            </div>
        </div>
    </div>
</footer> <!-- Footer content-->
<!-- JS -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const bankTransferRadio = document.getElementById('bankTransfer');
        const qrCodeDiv = document.getElementById('qrCode');

        bankTransferRadio.addEventListener('change', function () {
            if (this.checked) {
                qrCodeDiv.style.display = 'block';
            }
        });

        document.getElementById('cashOnDelivery').addEventListener('change', function () {
            if (this.checked) {
                qrCodeDiv.style.display = 'none';
            }
        });
    });
</script>
</body>

</html>